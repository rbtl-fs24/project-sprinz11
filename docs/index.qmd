---
title: "The willingness to walk to separate waste among Zurich's students"
subtitle: "Capstone Project for the lecture 'Research Beyond the Lab' FS24"
date: today
author:
  - name: "Sven Prinz"
    orcid: 0009-0000-4485-1235
    email: sprinz@ethz.ch
    affiliation: 
      - name: ETH Zurich
        url: https://ethz.ch/de.html
abstract: 
  PUT ABSTRACT HERE
license: "CC BY"
#citation: 
#  container-title: My Blog
#  url: https://www.example.com
bibliography: references.bib
csl: apa.csl  # other csls https://github.com/citation-style-language/styles
format:
  html:
    toc: true
    toc-depth: 5
    toc-expand: true
    embed-resources: true
#    fig-width: 6  
#    fig-asp: 0.618    # the golden ratio, only adjust fig-asp in chunks where needed
#    fig-align: center
#    out-width: "70%"
execute:
  cache: false   # regularily clear out by knitr::clean_cache()
# global chunk code options:
#  warning: false
editor: visual
editor_options: 
  chunk_output_type: console
---

```{r}
#| label: load-packages
#| include: true

library(tidyverse)
library(ggthemes)
library(ggridges)
library(gt)
library(gtsummary)
library(knitr)
library(DT)
```

```{r}
#| label: import-data
#| include: true

data_avail_wtw <- read_rds(here::here("data/processed/01-data_avail_wtw.rds"))
open_answers <- read_rds(here::here("data/processed/02-open_answers.rds"))

# data_dictionary <- read_csv(here::here("data/processed/00-data_dictionary.csv"))
```

## Task description

You will use the `index.qmd` file to write your final report. This will be a Quarto document that will contain your analysis and visualizations. You will need to access the processed data from the `data/processed` folder using the `read_csv()` function.

You will save the data underlying each displayed summary table and visualization in the `data/final` folder. This requires that each visualization and table is generated from an object that is not further transformed before the code for the visualization or table is written. Use the `write_csv()` function to save the data underlying each visualization and table in the `data/final` folder. Give the files the name of the label you have chosen inside the code-chunk. See example below.

```{r}
#| eval: false
#| echo: false
#| label: tbl-gapminder-mean
#| tbl-cap: "Mean values of life expectancy, GDP per capita, and population by continent"

# load libraries -------------------------------------

library(gapminder)
library(tidyverse)

# data analysis --------------------------------------

gapminder_mean <- gapminder |> 
  pivot_longer(cols = c(lifeExp, gdpPercap, pop), 
               names_to = "variable",
               values_to = "value") |> 
  group_by(continent, variable) |> 
  summarise(mean = mean(value),
            n = n()) |> 
  pivot_wider(names_from = variable, 
              values_from = mean) 

# results display as table ---------------------------
  
gapminder_mean |> 
  knitr::kable(digits = 0)

# save data underlying the table ----------------------

# write_csv(gapminder_mean, here::here("data/final/tbl-gapminder-mean.csv"))
```

# 

# Introduction

Introduction section with 3 to 5 sentences introduces the context within which the data was created.

According to the SDG Report 2023 ***(source SDG2023***), more than 80% of the OECD countries have major challenges remaining in the sector of SDG 12 - Responsible consumption and production. Among them is Switzerland, despite being ranked number 15 out of 166 countries in the overall country ranking, with SDG 12 among its worst categories.

This indicates clearly that major efforts in the reduction of s

Non-recycled municipal solid waste still poses significant challenges

Test @kassim2012importancea ... ; @sustainable ; [@sustainable] ...

# Methods

Methods section describes in 3 to 5 sentences how the data was obtained.

Survey distributed among group chats, friends, and random people on the campus.

All mentioned waste types can be separated on campus (already available)

# Results

Figures and tables in Results section are interpreted with 2 to 3 sentences each.

Blabla

As seen in @fig-avail-response , the students ...

```{r}
#| label: fig-avail-response
#| fig-cap: "Results of survey, student's answers to waste separation availability."

fig_avail_response <- data_avail_wtw |> 
  filter(avail_resp_short != "noa") |> 
  count(waste_type, avail_resp_short)

fig_avail_response |> 
  ggplot(aes(x = avail_resp_short, y = fct_rev(waste_type))) +  # https://www.perplexity.ai/search/When-using-ggplot-.9PkPLwERA2BJyVcRre66g
  geom_tile(aes(fill = n)) +
  labs(x = "Availability",
       y = "Waste type",
       fill = "# students")

# write_csv(fig_avail_response, here::here("data/final/fig-avail-response.csv"))
```

The necessity to improve information about the separation options can be seen more clearly, when combining the students that know of the existence but are not sure where with the students that do not know the option exists but would like to have it (@tbl-avail-response)

```{r}
#| label: tbl-avail-response
#| tbl-cap: "The answers provided on the survey and statistical data."

tbl_avail_response <- data_avail_wtw |> 
  group_by(waste_type) |> 
  count(waste_type, avail_resp_short) |> 
  pivot_wider(names_from = avail_resp_short,
              values_from = n) |> 
  select(-noa) |> 
  mutate(total_answers = cb + ebw + wl + nu) |>  # include "No answer"s?
  mutate(no_info = ebw + wl) |> 
  mutate(no_info_percent = no_info / total_answers *100) |> 
  select(no_info, total_answers, no_info_percent)

tbl_avail_response |> 
  gt() |> 
  tab_header(title = "A title.")


#  gt() |> 
#  tab_header(title = "A title.") |>
#  cols_label(improvements = "Proposed improvements")

# write_csv(tbl_avail_response, here::here("data/final/tbl-avail-response.csv"))
```

When looking at the willingness to walk, @fig-wtw-response shows ...

```{r}
#| label: fig-wtw-response
#| fig-cap: "Boxplot of the willingness to walk for appropriate separation on campus"

fig_wtw_response <- data_avail_wtw |> 
  filter(!is.na(wtw_resp_nr)) #remove residual waste and "No answer" responses

fig_wtw_response |> 
  ggplot(aes(x = wtw_resp_nr, y = fct_rev(waste_type))) +
  geom_boxplot(outlier.shape = NA) +
  labs(x = "Linearized distance to walk for respective waste type separation",
       y = "Waste type")

# write_csv(fig_wtw_response, here::here("data/final/fig-wtw-response.csv"))
```

Lastly, the questioned individuals had the option to finish the survey with possible improvements. These proposals are listed in @tbl-improvements .

```{r}
#| label: tbl-improvements
#| tbl-cap: "Proposed improvements (open answers)."

tbl_improvements <- open_answers |> 
  select(improvements) |> 
  filter(!(is.na(improvements)))

tbl_improvements |> 
  gt() |> 
  tab_header(title = "Improvements proposed by students.") |>
  cols_label(improvements = "Proposed improvements")

# write_csv(tbl_improvements, here::here("data/final/tbl-improvements.csv"))
```

# Conclusions

Conclusions concisely summarize findings in a bullet point format.

survey has shown the following points, ....

-   nr 1

-   nr 2

However, improving the waste separation only solves part of the problem. To reach the full potential in terms of saving energy, CO~2~ emissions and conserving resourcesmore specific separating and a standardized design of products are necessary. (***Klotz 2022 website)***...

# References
